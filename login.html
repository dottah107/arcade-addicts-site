<!DOCTYPE html>
<html>
<head>
<title>Login - Arcade Addicts</title>
<link rel='stylesheet' href='styles.css'>
</head>
<body>
<nav>
  <a href='register.html'>Register</a>
  <a href='reset.html'>Forgot Password?</a>
</nav>
<div class='container'>
  <h2>Login</h2>
  <div class='errmsg' id='errmsg'></div>
  <form id='loginForm'>
    <input type='email' id='email' placeholder='Email' autocomplete='username' required>
    <input type='password' id='password' placeholder='Password' autocomplete='current-password' required>
    <button type='submit'>Log In</button>
  </form>
  <div class='successmsg' id='successmsg'></div>
</div>
<script src='https://cdn.jsdelivr.net/npm/@supabase/supabase-js'></script>
<script>
const supabaseUrl = 'https://xvhkwyhncuivsfwfmvbg.supabase.co';
const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh2aGt3eWhuY3VpdnNmd2ZtdmJnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg4MzQxNjgsImV4cCI6MjA3NDQxMDE2OH0.oeCz6LHCCzLvHqO7q9cNiiiotrUm8kzmzdJjfzBIA-8';
const supabase = supabase.createClient(supabaseUrl, supabaseKey);

document.getElementById('loginForm').addEventListener('submit', async function (e) {
  e.preventDefault();
  document.getElementById('errmsg').textContent = '';
  document.getElementById('successmsg').textContent = '';
  const email = document.getElementById('email').value.trim();
  const password = document.getElementById('password').value;

  let { data, error } = await supabase.auth.signInWithPassword({ email, password });
  if(error){
    document.getElementById('errmsg').textContent = error.message;
  } else if(data && data.user) {
    document.getElementById('successmsg').textContent = 'Login successful! Redirecting...';
    setTimeout(()=>{ window.location.href='members.html'; },1200);
  }
});
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Members Page</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js/dist/umd/supabase.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; }
    #activity-feed { margin: 30px; }
    #activity-feed ul { list-style-type: none; padding: 0; }
    #activity-feed li { margin: 10px 0; border-bottom: 1px solid #eee; padding: 5px 0; }
  </style>
</head>
<body>
  <h1>Welcome to the Members Area</h1>
  <div id="activity-feed">
    <!-- Recent activity will appear here -->
  </div>

  <script>
    // Initialize Supabase client with your credentials
    const supabaseUrl = 'https://xvhkwyhncuivsfwfmvbg.supabase.co'
    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh2aGt3eWhuY3VpdnNmd2ZtdmJnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg4MzQxNjgsImV4cCI6MjA3NDQxMDE2OH0.oeCz6LHCCzLvHqO7q9cNiiiotrUm8kzmzdJjfzBIA-8'
    const supabase = supabase.createClient(supabaseUrl, supabaseKey);

    // Get current user
    async function getUser() {
      const { data: { session } } = await supabase.auth.getSession();
      return session?.user || null;
    }

    async function showRecentActivity() {
      const user = await getUser();
      if (!user) {
        document.getElementById('activity-feed').innerText = "You are not logged in.";
        return;
      }
      const { data, error } = await supabase
        .from('activity_feed')
        .select('*')
        .eq('user_id', user.id)
        .order('timestamp', { ascending: false })
        .limit(10);
      if (error) {
        document.getElementById('activity-feed').innerText = "Could not load activity.";
        return;
      }
      let html = '<ul>';
      for (let item of data) {
        html += `<li>${item.type} - ${item.name} (${item.timestamp})</li>`;
      }
      html += '</ul>';
      document.getElementById('activity-feed').innerHTML = html;
    }

    // Run this after page load
    showRecentActivity();
  </script>
</body>
</html>
